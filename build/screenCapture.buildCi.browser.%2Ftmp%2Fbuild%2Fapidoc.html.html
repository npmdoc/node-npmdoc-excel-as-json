<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/stevetarver/excel-as-json">excel-as-json (v2.0.0)</a>
</h1>
<h4>Convert Excel data to JSON</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.excel-as-json">module excel-as-json</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json._validateOptions">
            function <span class="apidocSignatureSpan">excel-as-json.</span>_validateOptions
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.assign">
            function <span class="apidocSignatureSpan">excel-as-json.</span>assign
            <span class="apidocSignatureSpan">(obj, key, value, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.convert">
            function <span class="apidocSignatureSpan">excel-as-json.</span>convert
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.convertValue">
            function <span class="apidocSignatureSpan">excel-as-json.</span>convertValue
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.parseKeyName">
            function <span class="apidocSignatureSpan">excel-as-json.</span>parseKeyName
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.processFile">
            function <span class="apidocSignatureSpan">excel-as-json.</span>processFile
            <span class="apidocSignatureSpan">(src, dst, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.excel-as-json.transpose">
            function <span class="apidocSignatureSpan">excel-as-json.</span>transpose
            <span class="apidocSignatureSpan">(matrix)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.excel-as-json" id="apidoc.module.excel-as-json">module excel-as-json</a></h1>


    <h2>
        <a href="#apidoc.element.excel-as-json._validateOptions" id="apidoc.element.excel-as-json._validateOptions">
        function <span class="apidocSignatureSpan">excel-as-json.</span>_validateOptions
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_validateOptions = function (options) {
  if (!options) {
    options = _DEFAULT_OPTIONS;
  } else {
    if (!options.hasOwnProperty('sheet')) {
      options.sheet = '1';
    } else {
      if (!isNaN(parseFloat(options.sheet)) &amp;&amp; isFinite(options.sheet)) {
        if (options.sheet &lt; 1) {
          options.sheet = '1';
        } else {
          options.sheet = '' + options.sheet;
        }
      } else {
        options.sheet = '1';
      }
    }
    if (!options.hasOwnProperty('isColOriented')) {
      options.isColOriented = false;
    }
    if (!options.hasOwnProperty('omitEmptyFields')) {
      options.omitEmptyFields = false;
    }
  }
  return options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.assign" id="apidoc.element.excel-as-json.assign">
        function <span class="apidocSignatureSpan">excel-as-json.</span>assign
        <span class="apidocSignatureSpan">(obj, key, value, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">assign = function (obj, key, value, options) {
  var i, index, j, keyIsList, keyName, ref, ref1, ref2;
  if (typeof key !== 'object') {
    key = key.split('.');
  }
  ref = parseKeyName(key.shift()), keyIsList = ref[0], keyName = ref[1], index = ref[2];
  if (key.length) {
    if (keyIsList) {
      if (isArray(obj[keyName])) {
        if (!obj[keyName][index]) {
          for (i = j = ref1 = obj[keyName].length, ref2 = index; ref1 &lt;= ref2 ? j &lt;= ref2 : j &gt;= ref2; i = ref1 &lt;= ref2 ? ++j : --
j) {
            obj[keyName].push({});
          }
        }
      } else {
        obj[keyName] = (function() {
          var k, ref3, results;
          results = [];
          for (i = k = 0, ref3 = index; 0 &lt;= ref3 ? k &lt;= ref3 : k &gt;= ref3; i = 0 &lt;= ref3 ? ++k : --k) {
            results.push({});
          }
          return results;
        })();
      }
      return assign(obj[keyName][index], key, value, options);
    } else {
      if (obj[keyName] == null) {
        obj[keyName] = {};
      }
      return assign(obj[keyName], key, value, options);
    }
  } else {
    if (keyIsList &amp;&amp; (index != null)) {
      console.error("WARNING: Unexpected key path terminal containing an indexed list for &lt;" + keyName + "&gt;");
      console.error("WARNING: Indexed arrays indicate a list of objects and should not be the last element in a key path");
      console.error("WARNING: The last element of a key path should be a key name or flat array. E.g. alias, aliases[]");
    }
    if (keyIsList &amp;&amp; (index == null)) {
      if (!(options.omitEmptyFields &amp;&amp; value === '')) {
        return obj[keyName] = convertValueList(value.split(';'));
      }
    } else {
      if (!(options.omitEmptyFields &amp;&amp; value === '')) {
        return obj[keyName] = convertValue(value);
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.convert" id="apidoc.element.excel-as-json.convert">
        function <span class="apidocSignatureSpan">excel-as-json.</span>convert
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">convert = function (data, options) {
  var index, item, j, k, keys, len, len1, result, row, rows, value;
  if (options.isColOriented) {
    data = transpose(data);
  }
  keys = data[0];
  rows = data.slice(1);
  result = [];
  for (j = 0, len = rows.length; j &lt; len; j++) {
    row = rows[j];
    item = {};
    for (index = k = 0, len1 = row.length; k &lt; len1; index = ++k) {
      value = row[index];
      assign(item, keys[index], value, options);
    }
    result.push(item);
  }
  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.convertValue" id="apidoc.element.excel-as-json.convertValue">
        function <span class="apidocSignatureSpan">excel-as-json.</span>convertValue
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">convertValue = function (value) {
  var testVal;
  if (value.length === 0 || !/\S/.test(value)) {
    return value;
  } else if (isFinite(value)) {
    return Number(value);
  } else {
    testVal = value.toLowerCase();
    if (indexOf.call(BOOLTEXT, testVal) &gt;= 0) {
      return BOOLVALS[testVal];
    } else {
      return value;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.parseKeyName" id="apidoc.element.excel-as-json.parseKeyName">
        function <span class="apidocSignatureSpan">excel-as-json.</span>parseKeyName
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseKeyName = function (key) {
  var index;
  index = key.match(/\[(\d+)\]$/);
  switch (false) {
    case !index:
      return [true, key.split('[')[0], Number(index[1])];
    case key.slice(-2) !== '[]':
      return [true, key.slice(0, -2), void 0];
    default:
      return [false, key, void 0];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.processFile" id="apidoc.element.excel-as-json.processFile">
        function <span class="apidocSignatureSpan">excel-as-json.</span>processFile
        <span class="apidocSignatureSpan">(src, dst, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">processFile = function (src, dst, options, callback) {
  if (options == null) {
    options = _DEFAULT_OPTIONS;
  }
  if (callback == null) {
    callback = void 0;
  }
  options = _validateOptions(options);
  if (!callback) {
    callback = function(err, data) {};
  }
  if (!fs.existsSync(src)) {
    return callback("Cannot find src file " + src);
  } else {
    return excel(src, options.sheet, function(err, data) {
      var result;
      if (err) {
        return callback("Error reading " + src + ": " + err);
      } else {
        result = convert(data, options);
        if (dst) {
          return write(result, dst, function(err) {
            if (err) {
              return callback(err);
            } else {
              return callback(void 0, result);
            }
          });
        } else {
          return callback(void 0, result);
        }
      }
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.excel-as-json.transpose" id="apidoc.element.excel-as-json.transpose">
        function <span class="apidocSignatureSpan">excel-as-json.</span>transpose
        <span class="apidocSignatureSpan">(matrix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">transpose = function (matrix) {
  var i, j, ref, results, t;
  results = [];
  for (i = j = 0, ref = matrix[0].length; 0 &lt;= ref ? j &lt; ref : j &gt; ref; i = 0 &lt;= ref ? ++j : --j) {
    results.push((function() {
      var k, len, results1;
      results1 = [];
      for (k = 0, len = matrix.length; k &lt; len; k++) {
        t = matrix[k];
        results1.push(t[i]);
      }
      return results1;
    })());
  }
  return results;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>